<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Protocoles d’antibiothérapie</title>
  <meta name="theme-color" content="#0f172a" />
  <link rel="stylesheet" href="styles.css?v=1.0.0"> 
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png" sizes="192x192">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="styles.css">

  <!-- Inclusion de pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
</head>
<body>
  <header class="appbar">
    <h1>Protocoles d’antibiothérapie<br><small>MIR – CHV André Mignot</small></h1>
  </header>

  <main id="app" class="container"><!-- rendu dynamique --></main>

  <footer class="footer">
  <small>
    Amicalement, Dr Antoine Brizard
  </small>
</footer>

<!-- Debug: détecter l'exacte ligne/colonne d'une erreur de syntaxe dans app.js -->
<script src="https://cdn.jsdelivr.net/npm/esprima@4.0.1/dist/esprima.min.js"></script>
<script>
(async () => {
  try {
    const res = await fetch('./app.js?v=1.0.0', { cache: 'no-store' });
    const src = await res.text();

    // Utilise parseModule car ton app.js est chargé en "module"
    esprima.parseModule(src, { loc: true });

    // Si on passe ici, la syntaxe est OK
    console.log('Syntaxe OK pour app.js');
  } catch (e) {
    // Esprima fournit lineNumber, column et description
    const line = e.lineNumber || 0;
    const col  = e.column || 0;
    const desc = e.description || e.message || 'Erreur de syntaxe';

    // Contexte : ±2 lignes autour
    const lines = (typeof src === 'string' ? src : '').split('\n');
    const start = Math.max(0, line - 3);
    const end   = Math.min(lines.length, line + 2);
    const ctx = lines.slice(start, end).map((l, i) => (start + i + 1) + '│ ' + l).join('\n');

    alert(`app.js – ${desc}\nLigne ${line}, Colonne ${col}\n\nContexte :\n${ctx}`);
    console.error('Erreur de syntaxe app.js:', { line, col, desc });
  }
})();
</script>

  <!-- Debug temporaire : localiser l’erreur de syntaxe dans app.js -->
<script src="https://cdn.jsdelivr.net/npm/esprima@4.0.1/dist/esprima.min.js"></script>
<script>
(async () => {
  try {
    const res = await fetch('./app.js?v=1.0.0', { cache: 'no-store' });
    const src = await res.text();
    esprima.parseScript(src, { loc: true }); // ou parseModule si tu utilises type="module"
    console.log('✔ Syntaxe OK pour app.js');
  } catch (e) {
    const line = e.lineNumber || 0;
    const col  = e.column || 0;
    const msg  = e.description || e.message || 'Erreur de syntaxe';
    alert(`app.js – ${msg}\nLigne ${line}, Colonne ${col}`);
    console.error('⛔ ERREUR DE SYNTAXE:', msg, '→ ligne:', line, 'colonne:', col);
  }
})();
</script>

  
  <script type="module" src="./app.js?v=1.0.0"></script>
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js", { scope: "./" });
      });
    }
  </script>
</body>
</html>
